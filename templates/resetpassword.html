<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html" style="overflow-x: auto;background: #FAFAFA">
<head>

    <!-- Webpage Title -->
    <title>비밀번호 재설정페이지</title>
    {% extends "layout_noNav.html" %}

    {% block head %}
    <!--기기 환경에 맞춰 스케일조절 -->
    <meta name="format-detection" content="telephone=no">
    <script>
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }
        if (isMobile()){
            //alert('is-mobile')
            $(document).ready(function (){
                $('.for_PC').remove()
                var mobile_nav_item = `<div style="padding-top: 2px">
                                            <a class="navbar-item" href='/search'>통합검색</a>
                                        </div>`
                //$('#nav_menu').prepend(mobile_nav_item)
                //document.querySelector('nav').firstElementChild.style.width='786px'
                //document.querySelector('#nav_menu').style.width='300px'
                document.querySelector('footer').style.width='786px'
                document.querySelector('footer').style.width='786px'
                $('#footer_left').append(`<p style="font-size: 12px;line-height: 21px">이메일 문의: help@readymate.kr</p>`)
                $('#footer_left_second').append(`<div style="cursor: pointer;font-size: 12px;line-height: 21px"
                                                     onclick="window.open('https://readymate.notion.site/78b989750d024461a5c90533f85a96a2')">환불 정책
                                                </div>`)
                $('#footer_right').remove()
                var initial_scale = (screen.width / $('footer').width()).toFixed(4);
                $('meta[name=viewport]').attr('content', '"width=device-width, initial-scale=' + initial_scale + ', maximum-scale=3.0, user-scalable=yes"');

            })
        }
    </script>
    <!--둥 -->
    <script type="text/javascript">

        function check_pw() {
            var eng = /[a-z,A-z]/gi;
            var num = /[0-9]/gi;
            var kor = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;
            var inputVal = $('#password').val();
            if (inputVal.match(kor)){$('#password').val(inputVal.slice(0,-1));alert('한글은 입력할 수 없습니다')}
            if (inputVal.search(/\s/) == -1) {
                if (inputVal.match(eng) && inputVal.match(num)) {
                    if ($('#password').val().length > 7 && $('#password').val().length < 21) {
                        $('#verified_pw').removeClass('is-hidden')
                    } else {
                        $('#verified_pw').addClass('is-hidden')
                    }
                } else {
                    $('#verified_pw').addClass('is-hidden')
                }
            } else {
                alert('띄어쓰기는 비밀번호에 사용할 수 없습니다')
                $('#password').val('')
                {
                    $('#verified_pw').addClass('is-hidden')
                }
            }
            console.log(inputVal)
        }

        function change_pw(){
            var check1 = $('#verified_pw').hasClass('is-hidden');
            var check2 = $('#verified_repw').hasClass('is-hidden');
            console.log(check1, check2)
            if (check1 == false && check2 == false){
                var pw = $('#password').val()
                var time = parseInt(new Date().getTime())
                $.ajax({
                    type: "POST",
                    url: "/change_pw",
                    data: {password_give: pw,name_give:'{{ Name }}' ,num_give: '{{Num}}', time_give:time},
                    success: function (response) {
                        var msg = response['msg']
                        alert(msg)
                        window.location.href='/login'
                    }
                });
            } else {
                alert('정정할 비밀번호를 확인해주세요')
            }
        }

        function sign_out() {
            //로그아웃
            if (confirm('정말로 로그아웃 하시겠습니까?')){
                $.removeCookie('mytoken', {path: '/'});
                window.location.href="/login"
            }
        }

    </script>
    <style>
        * {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
        }
        input{background: none}

        button:hover{opacity: 1;letter-spacing: 2px}

        .footer > div > p > a {
            font-size: 12px;
            color: black;
        }

        button {opacity: 0.85;transition-duration: 300ms;
            width: 378px;height: 40px;border-radius: 20px;
            border: none;
            color: white; letter-spacing: 1px;
            font-size: 18px;
            font-weight: 600;
            line-height: 21px;
        }

        input::placeholder {
            font-size: 12px;
        }
        .alert_box{
            width: 341px;min-height: 75px;max-height: 340px;background: white;border: 1px #dedede solid;border-radius: 4px;
            box-shadow: 2px 6px 2px rgba(0, 0, 0, 0.25);padding: 20px 25px 6px 25px;
            overflow-y: scroll;
        }
        .alert_delete_btn{background: none;border: white 1px solid;cursor: pointer;height: 20px;border-radius: 10px;line-height: 18px;color: #E94E58;font-size: 12px;position: absolute;right: 134px;top: 9px;transition-duration: 300ms}
        .alert_delete_btn:hover{font-weight: 600;border: #F08080 1px solid; }
        .follow_box{
            width: 480px;height: 70px;padding: 15px;background: #FAFAFA;border-radius: 4px;display: flex;
            position: relative;margin-bottom: 14px;
            cursor: pointer;
        }
        .follow_box >p {
            margin-left: 17px;line-height: 40px;text-overflow:ellipsis; width: 370px; overflow:hidden; white-space:nowrap
        }
        .red_dot{
            width: 12px;height: 12px;border-radius: 6px;background: #E94E58;
            position: absolute; right: 15px;top: 29px;
        }
    </style>
    {% endblock %}

    {% block content %}
<div id="initial_div" style="width: 378px; margin: 50px auto 0 auto">

    <p style="font-size: 21px; font-weight: 600;text-align: center;color: #333333">비밀번호 재설정</p>
    <br><br>
    <p style="text-align: center">{{ Name }}님, 새로 변경할 비밀번호를 입력해 주세요.</p>
    <br><br>

    <div style="margin-bottom: 16px;display: flex">
        <p>비밀번호</p>
        <p class="is-hidden" id="verified_pw" style="color: #577FF0">&nbsp;&nbsp;&nbsp;<i
                class="fa fa-check-circle-o" aria-hidden="true"></i></p>
    </div>
    <input id="password" type="password" oninput="check_pw()" placeholder="8-20자리의 영문, 숫자 혼용(대문자, 특수문자 가능)"
           style="width: 340px; border: none; border-bottom: #797979 1px solid; height: 40px; line-height: 40px">
    <button style="border: none;font-size: 18px;width: max-content; background: none;color: #333333;cursor: pointer" onmouseenter="$('#password').attr('type','text')" onmouseleave="$('#password').attr('type','password')"><i class="fa fa-eye" aria-hidden="true"></i></button>

    <div style="margin-top: 38px; margin-bottom: 16px;display: flex">
        <p>비밀번호 확인</p>
        <p class="is-hidden" id="verified_repw" style="color: #577FF0">&nbsp;&nbsp;&nbsp;<i
                class="fa fa-check-circle-o" aria-hidden="true"></i></p>
    </div>
    <input id="re_password" placeholder="비밀번호가 동일해야 합니다" type="password" oninput="if ($('#re_password').val() == $('#password').val()){$('#verified_repw').removeClass('is-hidden')}else {$('#verified_repw').addClass('is-hidden')}"
           style="width: 340px; border: none; border-bottom: #797979 1px solid; height: 40px; line-height: 40px">
    <br><br><br><br>

    <button onclick="change_pw()" style="background: linear-gradient(105deg, #577FF0 0%, #3F61CE 100%);">비밀번호 변경하기</button>
</div>
    {% endblock %}
