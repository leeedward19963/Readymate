<!doctype html>
<html lang="en" style="overflow-x: auto;background: #FAFAFA">
<head>

    <!-- Webpage Title -->
    <title>{{ menti_info.nickname }}님의 마이페이지</title>
    {% extends "layout_2.html" %}

    {% block head %}

    <style>
        * {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
        }

        .navbar-item{font-weight: 600;font-size: 15px;transition-duration: 0.3s;}
        .navbar-item:hover {
            background-color: #FAFAFA;
            color: #577FF0;
        }
        .dropdown-item{transition-duration: 250ms}
        .dropdown-item:hover {
            letter-spacing: 2px;
        }
        #nav_drop_logout:hover{
            color: #F08080;
        }

        .div_up {
            width: 0px;
            height: 0px;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 12px solid #dedede;
            margin-left: 158.5px;
        }

        .box{
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
        .box::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera*/
        }
        .modal-content{
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
        .modal-content::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera*/
        }
        button{
            opacity: 0.85;
            transition-duration: 300ms
        }
        button:hover{
            opacity: 1;
            letter-spacing: 2px
        }

        .alert_box{
            width: 341px;min-height: 75px;max-height: 340px;background: white;border: 1px #dedede solid;border-radius: 4px;
            box-shadow: 2px 6px 2px rgba(0, 0, 0, 0.25);padding: 20px 25px 6px 25px;
            overflow-y: scroll;
        }
        .alert_delete_btn{background: none;border: white 1px solid;cursor: pointer;height: 20px;border-radius: 10px;line-height: 18px;color: #E94E58;font-size: 12px;position: absolute;right: 134px;top: 9px;transition-duration: 300ms}
        .alert_delete_btn:hover{font-weight: 600;border: #F08080 1px solid;}
        .follow_box{
            width: 480px;height: 70px;padding: 15px;background: #FAFAFA;border-radius: 4px;display: flex;
            position: relative;margin-bottom: 14px;
            cursor: pointer;
        }
        .follow_box >p {
            margin-left: 17px;line-height: 40px;text-overflow:ellipsis; width: 370px; overflow:hidden; white-space:nowrap
        }
        .red_dot{
            width: 12px;height: 12px;border-radius: 6px;background: #E94E58;
            position: absolute; right: 15px;top: 29px;
        }

        /* Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Firefox */
        input[type=number] {
            -moz-appearance: textfield;
        }

        .head {
            font-size: 21px; font-weight: 500;
            color: #595959;
            margin-bottom: 30px;
            cursor: pointer; transition-duration: 200ms;
        }
        .head:hover {
            font-size: 24px;
            font-weight: 700;
            color: #333333;
        }
        .selectedTab{
            color: #333333;font-weight: 700
        }

        .empty_list{
            width: 990px; height: 154px;background: white;border-radius: 4px;border: #dedede 1px solid;
            text-align: center;line-height: 148px;color: #797979;
        }
        .product_card_body {
            text-align: right; color: #333333;line-height: 21px;position: relative;
            width: 276px;
            height: 186px;
            background: linear-gradient(136.34deg, rgba(115, 81, 225, 0.15) 25.51%, rgba(87, 127, 240, 0.15) 51.59%, rgba(82, 192, 226, 0.15) 75.59%);
            border-radius: 4px;
            padding: 14px 24px 18px 0;cursor: pointer;
            transition-duration:  350ms;
        }
        .product_card_body:hover {
            box-shadow: rgba(119, 43, 172, 0.15) 10px 0 70px 0px inset;
        }
        .product_desc{
            width: 695px; height: 186px; margin-left: 19px;
        }
        .un_bookmark_btn {
            color: #577FF0;font-size: 14px;background: none;border:#577FF0 1px solid;width: 130px;height: 34px;border-radius: 7px
        }
        .un_wishlist_btn {
            color: #55DBC2;font-size: 14px;background: none;border:#55DBC2 1px solid;width: 130px;height: 34px;border-radius: 7px
        }

        .footer > div > p > a {
            font-size: 12px;
            color: black;
        }
    </style>
    <script type="text/javascript">
        var miniTab1Array=[];
        var miniTab2Array=[];
        var miniTab3Array=[];
        var miniTab4Array=[];
        var listCount;
        var rec_num;
        var res_num;

        function sign_out() {
            //로그아웃
            if (confirm('정말로 로그아웃 하시겠습니까?')){
                $.removeCookie('mytoken', {path: '/'});
                window.location.href="/login"
            }
        }

        $(document).ready(function () {
            filter(0);miniTab({{ param|int }})

        })
        function totop() {
            $("html, body").animate({scrollTop: 0}, 240);
        }

        function miniTab(i){
            var emptyMentArray = ['구매한 데이터가 없습니다. 연간 패스 구매 내역은 좌측 탭의 ‘연간 패스 관리’에서 확인해주세요','스트리밍한 데이터는 레디메이트 연간 패스를 구매한 멘티에게 제공됩니다. 레디메이트 연간 패스로 데이터를 무제한 스트리밍하세요','스크랩한 데이터가 없습니다','찜한 데이터가 없습니다'];
            $('.empty_list').text(emptyMentArray[i-1])
            $('#head_2_1, #head_2_2, #head_2_3, #head_2_4').removeClass('selectedTab')
            $(`#head_2_${i}`).addClass('selectedTab')

            //탭에 따라 맞는 정보 겟.
            //겟해서 위서 전역으로 선언한 array를 채움.
            //반복문을 돌면서 mydatalist에 append
            //append시킬 원형은 아래에 기본형 만들어둠.
            //desc 부분에 id_1,2,3,4 붙여놓은 부분이 tab1,2,3,4에 따라 받아올 데이터.
            $('.desc_1,.desc_2,.desc_3,.desc_4').addClass('is-hidden')
            $(`.desc_${i}`).removeClass('is-hidden')


            listCount = document.querySelector('#mydata_list');
            if ( i== 1){
                $('.item').addClass('is-hidden')
                $('.buy').removeClass('is-hidden')
            } else if (i==2){
                $('.item').addClass('is-hidden')
                $('.streaming').removeClass('is-hidden')
            } else if (i==3){
                $('.item').addClass('is-hidden')
                $('.bookmark').removeClass('is-hidden')
            } else {
                $('.item').addClass('is-hidden')
                $('.wishlist').removeClass('is-hidden')
            }
            rec_num = listCount.querySelectorAll('.rec:not(.is-hidden)').length;
            res_num = listCount.querySelectorAll('.res:not(.is-hidden)').length;

            var total_num = rec_num + res_num
            console.log(total_num,rec_num,res_num)
            $('#tNum').text(total_num);$('#recNum').text(rec_num);$('#resNum').text(res_num);
            if (total_num == 0) {
                $('#mydata_list').addClass('is-hidden')
                $('.empty_list').removeClass('is-hidden')
            } else {
                $('#mydata_list').removeClass('is-hidden')
                $('.empty_list').addClass('is-hidden')
            }
            ///총 몇개의 데이터 보이는 그거
        }

        function filter(i) {
            if (i==0){
                $('.rec').removeClass('is-hidden')
                $('.res').removeClass('is-hidden')
            } else if (i==1){
                if (rec_num == 0){
                    $('#mydata_list').addClass('is-hidden')
                    $('.empty_list').removeClass('is-hidden')
                } else {
                    $('#mydata_list').removeClass('is-hidden')
                    $('.empty_list').addClass('is-hidden')
                    $('.rec').removeClass('is-hidden')
                    $('.res').addClass('is-hidden')
                }
            } else if (i==2){
                if (res_num == 0){
                    $('#mydata_list').addClass('is-hidden')
                    $('.empty_list').removeClass('is-hidden')
                } else {
                    $('#mydata_list').removeClass('is-hidden')
                    $('.empty_list').addClass('is-hidden')
                    $('.rec').addClass('is-hidden')
                    $('.res').removeClass('is-hidden')
                }
            }
        }

        function sign_out() {
            $.removeCookie('mytoken', {path: '/'});
            alert('다음에 또 만나요!');
            window.location.href="/login"
        }

    </script>
    {% endblock %}

    {% block content %}
<div style="width: 1194px; margin: 90px auto 40px auto">
    <div style="display: flex; margin-bottom: 80px">
        <div style="width: 72px;height: 72px;overflow: hidden;border-radius: 36px;border: none;">
            <img src="../static/{{ menti_info.profile_pic_real }}"
                 style="width:100%;height: 100%;object-fit: cover;">
        </div>

        <div style="margin-left: 30px; height: 72px;">
            <div style="color: #111111;font-size: 24px; margin-bottom: 11px">{{ menti_info.nickname }}</div>
            <p style="border: none; color: #595959;width: 800px;font-size: 14px;">
                {% if menti_info.phone %}
                    {{ menti_info.phone }}
                {% else %}
                    {{ menti_info.email }}
                {% endif %}
            </p>
        </div>
    </div>
    <div style="display: flex;position: relative">
        <div style="width: 174px;margin-right: 40px">
            <div style="position: sticky;top: 70px;left: 0px">
                <div onclick="window.location.href='/menti_mypage_pass/{{ menti_info.nickname }}'" onmouseover="$('#head_3_1, #head_3_2').addClass('is-hidden');" id="head_1" class="head">연간 패스/결제</div>
                <div onclick="miniTab(1)" id="head_2" class="head" style="font-size: 24px;font-weight: 700;color: #333333;">내 데이터</div>
                <div onclick="miniTab(1)" id="head_2_1" class="head selectedTab" style="font-size: 16px;margin-top: -18px">구매한 데이터</div>
                <div onclick="miniTab(2)" id="head_2_2" class="head" style="font-size: 16px;margin-top: -18px">스트리밍한 데이터</div>
                <div onclick="miniTab(3)" id="head_2_3" class="head" style="font-size: 16px;margin-top: -18px">스크랩</div>
                <div onclick="miniTab(4)" id="head_2_4" class="head" style="font-size: 16px;margin-top: -18px">찜한 데이터</div>
                <div onclick="window.location.href='/menti_mypage_mystory/{{ menti_info.nickname }}?mt=1'" onmouseover="$('#head_3_1, #head_3_2').removeClass('is-hidden')" id="head_3" class="head">내 스토리</div>
                <div onclick="window.location.href='/menti_mypage_mystory/{{ menti_info.nickname }}?mt=1'" id="head_3_1" class="head is-hidden" style="font-size: 16px;margin-top: -18px">스트리밍한 스토리</div>
                <div onclick="window.location.href='/menti_mypage_mystory/{{ menti_info.nickname }}?mt=2'" id="head_3_2" class="head is-hidden" style="font-size: 16px;margin-top: -18px">스크랩</div>
                <div onclick="window.location.href='/menti_mypage_info/{{ menti_info.nickname }}'" onmouseover="$('#head_3_1, #head_3_2').addClass('is-hidden');" id="head_4" class="head">회원정보수정</div>
            </div>
        </div>
<!--        좌측 탭-->

        <div style="width: 990px">
            <p style="">카테고리</p><br>
            <div style="display: flex">
                <label onclick="filter(0)" style="width: 200px;padding-left: 30px;;border-right: #797979 1px solid"><input style="zoom: 1.8;vertical-align: text-bottom" type="radio" name="category">&nbsp;&nbsp;전체 (<span id="tNum"></span>)</label>
                <label onclick="filter(1)" style="width: 240px;padding-left: 30px;border-right: #797979 1px solid"><input style="zoom: 1.8;vertical-align: text-bottom" type="radio" name="category">&nbsp;&nbsp;학교생활기록부 (<span id="recNum"></span>)</label>
                <label onclick="filter(2)" style="width: 240px;padding-left: 30px;"><input style="zoom: 1.8;vertical-align: text-bottom" type="radio" name="category">&nbsp;&nbsp;자기소개서 (<span id="resNum"></span>)</label>
            </div>

            <hr>

            <div id="mydata_list">
                {% for item in my_data %}
                    {% if item['category'] == 'recordpaper' %}
                        <div class="item rec {{ item['miniTab'] }}"
                             style="display: flex;width: 990px; height: 212px;padding: 13px 0;border-bottom: 1px solid #F1F1F1;">
                    {% elif item['category'] == 'resume' %}
                        <div class="item res {{ item['miniTab'] }}"
                             style="display: flex;width: 990px; height: 212px;padding: 13px 0;border-bottom: 1px solid #F1F1F1;">
                    {% endif %}
                            <div style="width: 276px;display: flex">
                    {% if item['category'] == 'recordpaper' %}
                        <div onclick="window.location.href='/recordpaper_sell/{{ item['mentor_num'] }}'" class="product_card_body">
                            <div style="width: 84px;height: 84px;overflow: hidden;border-radius: 43px;margin: 0 0 18px 172px;border: #577FF0 4px solid">
                                <div style="width: 76px;height: 76px;overflow: hidden;border-radius: 38px;background-clip: padding-box;border: rgba(0,0,0,0) 5px solid;">
                                    <img src="../static/{{ item['img'] }}" style="width:100%;height: 100%;object-fit: cover;">
                                </div>
                            </div>
                            <div style="z-index: 2;position: absolute;right: 22px;top: 76px;background: none;"><img style="height: 28px;margin-top: -6px" src="../static/emoji/recordpaper.png"></div>
                            <div style="font-size: 12px;text-align: right; color: #595959;line-height: 22px">
                                <p style="font-weight: bold">{{ item['univ'] }}</p>
                                <p style="font-size: 12px">{{ item['major'] }} {{ item['student_num'] }}학번</p>
                                <p style="font-size: 12px">{{ item['type'] }}</p>
                            </div>
                        </div>
                    {% elif item['category'] == 'resume' %}
                        <div onclick="window.location.href='/resume_sell/{{ item['mentor_num'] }}/{{ item['product'] }}'" class="product_card_body">
                            <div style="width: 84px;height: 84px;overflow: hidden;border-radius: 43px;margin: 0 0 18px 172px;border: #7351E1 4px solid">
                                <div style="width: 76px;height: 76px;overflow: hidden;border-radius: 38px;background-clip: padding-box;border: rgba(0,0,0,0) 5px solid;">
                                    <img src="../static/{{ item['img'] }}" style="width:100%;height: 100%;object-fit: cover;">
                                </div>
                            </div>
                            <div style="z-index: 2;position: absolute;right: 22px;top: 76px;background: none;"><img style="height: 28px;margin-top: -6px" src="../static/emoji/resume.png"></div>
                            <div style="font-size: 12px;text-align: right; color: #595959;line-height: 22px">
                                <p style="font-weight: bold">{{ item['univ'] }}</p>
                                <p style="font-size: 12px">{{ item['major'] }} {{ item['student_num'] }}학번</p>
                                <p style="font-size: 12px">{{ item['type'] }}</p>
                            </div>
                        </div>
                    {% endif %}
                </div>
                            <div class="product_desc" style="position: relative">
                    {% if item['category'] == 'recordpaper' %}
                        <p style="font-size: 12px; color: #595959;">학교생활기록부</p>
                    {% elif item['category'] == 'resume' %}
                        <p style="font-size: 12px; color: #595959;">자기소개서</p>
                    {% endif %}
                    <p style="color: #111111">{{ item['title'] }}</p>
                    <p style="margin-top: 4px;color: #797979; font-size: 14px">
                        <img style="height: 12px;margin-top: -6px" src="../static/emoji/like.png">&nbsp; <span style="font-size: 14px">{{ item['like'] }}</span>&nbsp;&nbsp;&nbsp; <img style="height: 12px;margin-top: -6px" src="../static/emoji/reply.png">&nbsp;
                        <span style="font-size: 14px">{{ item['reply'] }}</span>
                    </p>
                    <div>
                        <div id="" class="is-hidden desc_1" style="position: absolute;bottom: 5px">
                            <p style="font-size: 12px;color: #595959"><i class="fa fa-clock-o" aria-hidden="true"></i> 이
                                데이터는 앞으로 <span style="font-size: 12px">{{ item['exp'] }}</span>까지 열람할 수 있습니다.</p>
                            <p style="font-size: 12px;color: #595959"><i class="fa fa-eye" aria-hidden="true"></i> <span
                                    style="font-size: 12px;color: #595959">{{ item['time'] }}</span> 읽음</p>
                        </div>
                        <div id="" class="is-hidden desc_2" style="position: absolute;bottom: 5px">
                            <p class="hide_warning" style="font-size: 12px;color: #595959"><i class="fa fa-clock-o"
                                                                                              aria-hidden="true"></i> 이
                                데이터는 멘토의 요청으로 {{ item['exp'] }} 부터 열람할 수 없습니다.</p>
                            <p style="font-size: 12px;color: #595959"><i class="fa fa-eye" aria-hidden="true"></i> <span
                                    style="font-size: 12px;color: #595959">{{ item['time'] }}</span> 읽음</p>
                        </div>
                        <div id="" class="is-hidden desc_3" style="position: absolute;bottom: 5px;right: 57px">
                            <button style="cursor:pointer" onclick="bookmark_remove()" class="un_bookmark_btn">
                                <i class="fa fa-bookmark" aria-hidden="true"></i> 스크랩 취소
                            </button>
                        </div>
                        <script>
                            function bookmark_remove() {
                                $.ajax({
                                    type: "POST",
                                    url: "/bookmark_remove",
                                    data: {number_give:"{{ item['mentor_num'] }}", category_give:"{{ item['category'] }}", time_give:"{{ item['product'] }}"},
                                    success: function (response) {
                                        window.location.reload()
                                    }
                                });
                            }
                        </script>
                        <div id="" class="is-hidden desc_4" style="position: absolute;bottom: 5px;display: flex;">
                            <div style="margin-right: 414px">
                                <span style="font-size: 21px;font-weight: 600">{{ item['price'][:-3] }},{{ item['price'][-3:] }}</span> 원
                            </div>
                            <button style="cursor:pointer" onclick="wishlist_remove()" class="un_wishlist_btn">
                                <i class="fa fa-check" aria-hidden="true"></i> 찜하기 취소
                            </button>
                        </div>
                        <script>
                            function wishlist_remove() {
                                $.ajax({
                                    type: "POST",
                                    url: "/wishlist_remove",
                                    data: {number_give:"{{ item['mentor_num'] }}", category_give:"{{ item['category'] }}", time_give:"{{ item['product'] }}"},
                                    success: function (response) {
                                        window.location.reload()
                                    }
                                });
                            }
                        </script>
                    </div>
                </div>
                        </div>
                {% endfor %}
            </div>
            <div class="empty_list"></div>
        </div>
    </div>
</div>
    {% endblock %}