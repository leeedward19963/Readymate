<!doctype html>
<html lang="en" style="overflow-x: auto;background: #FAFAFA">
<head>

    <!-- Webpage Title -->
    <title>{{ mentor_info.nickname }}님의 데이터</title>
    {% extends "layout_2.html" %}

    {% block head %}

    <style>
        * {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
        }

        .navbar-item{font-weight: 600;font-size: 15px;transition-duration: 0.3s;}
        .navbar-item:hover {
            background-color: #FAFAFA;
            color: #577FF0;
        }
        .dropdown-item{transition-duration: 250ms}
        .dropdown-item:hover {
            letter-spacing: 2px;
        }
        #nav_drop_logout:hover{
            color: #F08080;
        }

        .div_up {
            width: 0px;
            height: 0px;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 12px solid #dedede;
            margin-left: 158.5px;
        }

        .box{
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
        .box::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera*/
        }
        .modal-content{
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
        .modal-content::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera*/
        }
        button{
            opacity: 0.85;
            transition-duration: 300ms
        }
        button:hover{
            opacity: 1;
            letter-spacing: 2px
        }

        .alert_box{
            width: 341px;min-height: 75px;max-height: 340px;background: white;border: 1px #dedede solid;border-radius: 4px;
            box-shadow: 2px 6px 2px rgba(0, 0, 0, 0.25);padding: 20px 25px 6px 25px;
            overflow-y: scroll;
        }
        .alert_delete_btn{background: none;border: white 1px solid;cursor: pointer;height: 20px;border-radius: 10px;line-height: 18px;color: #E94E58;font-size: 12px;position: absolute;right: 134px;top: 9px;transition-duration: 300ms}
        .alert_delete_btn:hover{font-weight: 600;border: #F08080 1px solid;}
        .follow_box{
            width: 480px;height: 70px;padding: 15px;background: #FAFAFA;border-radius: 4px;display: flex;
            position: relative;margin-bottom: 14px;
            cursor: pointer;
        }
        .follow_box >p {
            margin-left: 17px;line-height: 40px;text-overflow:ellipsis; width: 370px; overflow:hidden; white-space:nowrap
        }
        .red_dot{
            width: 12px;height: 12px;border-radius: 6px;background: #E94E58;
            position: absolute; right: 15px;top: 29px;
        }
        .drop_select:hover{font-weight: 600}

        .user_tag {
            width: max-content; height: 27px; border-radius: 13.5px; border: #DDE9FE 1px solid;
            background: #DDE9FE; color: #577FF0; text-align: center; font-size: 12px;
            padding: 3px 12px; margin: 0 10px 8px 0; cursor: pointer;transition-duration: 300ms;
        }

        .user_tag:hover {
            border: #577FF0 1px solid;
        }

        .susi-jungsi {
            width: 35px;
            height: 20px;
            border-radius: 10px;
            color: #7351E1;
            border: #7351E1 1px solid;
            font-size: 12px;
            text-align: center;
            line-height: 18px;
            margin-right: 8px;
        }
        .attending {
            width: 35px;
            height: 20px;
            border-radius: 10px;
            color: #577FF0;
            border: #577FF0 1px solid;
            font-size: 12px;
            text-align: center;
            line-height: 18px;
            margin-right: 8px;
        }
        .daepyo {
            width: 35px;
            height: 20px;
            border-radius: 10px;
            color: #1B2F8B;
            border: #1B2F8B 1px solid;
            font-size: 12px;
            text-align: center;
            line-height: 18px;
            margin-right: 8px;
        }

        .product_card_body {
            text-align: right; color: #333333;line-height: 21px;position: relative;
            width: 276px;
            height: 186px;
            background: linear-gradient(136.34deg, rgba(115, 81, 225, 0.15) 25.51%, rgba(87, 127, 240, 0.15) 51.59%, rgba(82, 192, 226, 0.15) 75.59%);
            border-radius: 4px;
            padding: 14px 24px 18px 0;cursor: pointer;
            transition-duration:  350ms;
        }
        .product_card_body:hover {
            box-shadow: rgba(119, 43, 172, 0.15) 10px 0 70px 0px inset;
        }

        .modify_btn {
            font-size: 14px;
            cursor: pointer;
            border: #577FF0 1px solid;
            color: #577FF0;
            min-width: 78px;
            margin-left: 12px;
            height: 24px;
            border-radius: 14px;
            background-color: white;
        }
        .grana {
            width: 162px;
            height: 30px;
            border-radius: 15px;
            border: none;
            color: white;
            margin: 5px 0;
        }

        input[type=radio]{
            zoom: 1.6; margin: 0px 8px 0px 0;
        }
        select{background: none}

        .footer > div > p > a {
            font-size: 12px;
            color: black;
        }
    </style>
    <script type="text/javascript">
        var mentorNumArray=[{{ mentor_info.number }}]
        var proARR;
        var filterNumNow;

        $(document).ready(function () {
            get_product()
            $('#filter{{ ft }}Label').click()
        })
        function update_count(){
            var listCount = document.getElementsByClassName('product').length
            $('#mydata_count').text(listCount)
        }

        function get_product() {
            console.log('get product of these mentors:', mentorNumArray)
            var arr = mentorNumArray
            //alert('get PRODUCT')
            $.ajax({
                type: "GET",
                url: `/get_product?array_give=${arr}`,
                data: {},
                success: function (response) {
                    proARR = response['products']
                    make_product_card()
                }
            })
        }
        //리얼라인된 멘토넘버를 토대로 프로덕트카드 정보 겟

        function make_product_card(){
            console.log('proARR(make) ',proARR)
            var sort = $('#sort_val').val()
            if(sort == '인기순'){
                proARR.sort(function (a, b) {
                    return b['visit'] - a['visit'];
                })
            } else if (sort == '높은가격순'){
                proARR.sort(function (a, b) {
                    return b['price'] - a['price'];
                })
            } else if (sort == '낮은가격순'){
                proARR.sort(function (a, b) {
                    return a['price'] - b['price'];
                })
            }
            $('.product').remove()
            for (let i = 0; i < proARR.length; i++) {
                var divClass;
                if (proARR[i]['category'] == '학교생활기록부') {
                    divClass = `<div class="product rec" style="width: 276px;height: 365px;margin-right:30px;margin-bottom:20px">
                                            <div onclick="window.location.href='/recordpaper_sell/${proARR[i]['mentor_num']}'" class="product_card_body" style="animation:0.1s cubic-bezier(0.1, 0, 0.6, 1) 0.3s 1 normal backwards running fcEaNs !important;">
                                                <div class="product_line" style="width: 84px; height: 84px;border-radius: 43px;border: #577FF0 4px solid;margin: 0 0 8px 172px">
                                                    <div style="width: 76px;height: 76px;overflow: hidden;border-radius: 38px;background-clip: padding-box;border: rgba(0,0,0,0) 5px solid;">
                                                        <img src="../static/${proARR[i]['img']}" style="width:100%;height: 100%;object-fit: cover;">
                                                    </div>
                                                </div>
                                                <div style="z-index: 2;position: absolute;right: 22px;top: 76px;background: none;"><img style="height: 28px;margin-top: -6px" src="../static/emoji/recordpaper.png"></div>`
                } else if (proARR[i]['category'] == '자기소개서') {
                    divClass = `<div class="product res" style="width: 276px;height: 365px;margin-right:30px;margin-bottom:20px">
                                            <div onclick="window.location.href='/resume_sell/${proARR[i]['mentor_num']}/${proARR[i]['time']}'" class="product_card_body" style="animation:0.1s cubic-bezier(0.1, 0, 0.6, 1) 0.3s 1 normal backwards running fcEaNs !important;">
                                                <div class="product_line" style="width: 84px; height: 84px;border-radius: 43px;border: #7351E1 4px solid;margin: 0 0 8px 172px">
                                                    <div style="width: 76px;height: 76px;overflow: hidden;border-radius: 38px;background-clip: padding-box;border: rgba(0,0,0,0) 5px solid;">
                                                        <img src="../static/${proARR[i]['img']}" style="width:100%;height: 100%;object-fit: cover;">
                                                    </div>
                                                </div>
                                                <div style="z-index: 2;position: absolute;right: 22px;top: 76px;background: none;"><img style="height: 28px;margin-top: -6px" src="../static/emoji/resume.png"></div>`
                } else {
                    divClass = `<div class="product sto" style="width: 276px;height: 365px;margin-right:30px;margin-bottom:20px">
                                            <div onclick="window.location.href='/story/${proARR[i]['mentor_num']}/${proARR[i]['time']}'" class="product_card_body" style="animation:0.1s cubic-bezier(0.1, 0, 0.6, 1) 0.3s 1 normal backwards running fcEaNs !important;">
                                                <div class="product_line" style="width: 84px; height: 84px;border-radius: 43px;border: #55DBC2 4px solid;margin: 0 0 8px 172px">
                                                    <div style="width: 76px;height: 76px;overflow: hidden;border-radius: 38px;background-clip: padding-box;border: rgba(0,0,0,0) 5px solid;">
                                                        <img src="../static/${proARR[i]['img']}" style="width:100%;height: 100%;object-fit: cover;">
                                                    </div>
                                                </div>
                                                <div style="z-index: 2;position: absolute;right: 22px;top: 76px;background: none;"><img style="height: 28px;margin-top: -6px" src="../static/emoji/resume.png"></div>`
                }

                var pPrice;
                if (proARR[i]['price'] != "") {
                    var e = `${proARR[i]['price']}`
                    var e1 = e.slice(0,2)
                    var e2 = e.slice(-3)
                    pPrice = `<p style="margin-top: 23px;bottom: 0px"><span
                                                            style="font-size: 21px;">${e1},${e2}</span> 원
                                                    </p>`
                } else {
                    pPrice = ``
                }

                var temp_html
                if (proARR[i]['category'] == '스토리') {
                    temp_html = divClass +
                        `<div style="font-size: 12px;text-align: right; color: #595959;line-height: 22px">
                                                        <p style="font-size: 14px;font-weight: 600">${proARR[i]['univ']}</p>
                                                        <p style="font-size: 12px">${proARR[i]['major']} ${proARR[i]['student_num']}학번</p>
                                                        <p style="font-size: 12px">${proARR[i]['type']}</p>
                                                    </div>
                                                </div>

                                                <div style="width: 100%;position: relative;height:170px;margin-top: 14px">
                                                    <p style="font-size: 12px; font-weight: 400">${proARR[i]['category']} &#183; ${proARR[i]['tag']}</p>
                                                    <p class="tagSameCountArea2" style="height: 48px;color: #333333">${proARR[i]['title']}</p>
                                                    <p style="color: #797979;margin-top: 14px"><img style="height: 12px;margin-top: -6px" src="../static/emoji/like.png"> <span style="font-size: 14px">${proARR[i]['like']}</span>&nbsp;&nbsp;&nbsp;<img style="height: 12px;margin-top: -6px" src="../static/emoji/reply.png"> <span
                                                            style="font-size: 14px">${proARR[i]['reply']}</span></p>`
                        + pPrice +
                        `</div></div>
                                            </div>
                                            <hr>
                                        </div>`
                }
                else {
                    temp_html = divClass +
                        `<div style="font-size: 12px;text-align: right; color: #595959;line-height: 22px">
                                                        <p style="font-size: 14px;font-weight: 600">${proARR[i]['univ']}</p>
                                                        <p style="font-size: 12px">${proARR[i]['major']} ${proARR[i]['student_num']}학번</p>
                                                        <p style="font-size: 12px">${proARR[i]['type']}</p>
                                                    </div>
                                                </div>

                                                <div style="width: 100%;position: relative;height:170px;margin-top: 14px">
                                                    <p style="font-size: 12px; font-weight: 400">${proARR[i]['category']}</p>
                                                    <p class="tagSameCountArea2" style="height: 48px;color: #333333">${proARR[i]['title']}</p>
                                                    <p style="color: #797979;margin-top: 14px"><img style="height: 12px;margin-top: -6px" src="../static/emoji/like.png"> <span style="font-size: 14px">${proARR[i]['like']}</span>&nbsp;&nbsp;&nbsp;<img style="height: 12px;margin-top: -6px" src="../static/emoji/reply.png"> <span
                                                            style="font-size: 14px">${proARR[i]['reply']}</span></p>`
                        + pPrice +
                        `</div></div>
                                            </div>
                                            <hr>
                                        </div>`
                }
                $('#mydata_list').append(temp_html)
                update_count()
                filter(filterNumNow)
            }
        }

        function follow(num,action) {
            $.ajax({
                type: "POST",
                url: "/follow",
                data: {mentor_num:num, action:action},
                success: function (response) {
                    window.location.reload()
                }
            });
        }

        function click_action_mentor(nickname){
            $.ajax({
                type: "POST",
                url: "/click_action_mentor",
                data: {nickname:nickname},
                success: function (response) {
                    window.location.href=`/user_mentor/${nickname}`
                }
            });
        }

        function totop() {
            $("html, body").animate({scrollTop: 0}, 240);
        }

        function filter(i) {
            $('.product').addClass('is-hidden')
            if (i == 0) {
                $('.rec').removeClass('is-hidden')
                $('.res').removeClass('is-hidden')
                $('.sto').removeClass('is-hidden')
                filterNumNow = 0
                var listCount = document.getElementsByClassName('product').length
                $('#mydata_count').text(listCount)
            } else if (i == 1) {
                $('.rec').removeClass('is-hidden')
                filterNumNow = 1
                var listCount = document.getElementsByClassName('rec').length
                $('#mydata_count').text(listCount)
            } else if (i == 2) {
                $('.res').removeClass('is-hidden')
                filterNumNow = 2
                var listCount = document.getElementsByClassName('res').length
                $('#mydata_count').text(listCount)
            } else {
                $('.sto').removeClass('is-hidden')
                filterNumNow = 3
                var listCount = document.getElementsByClassName('sto').length
                $('#mydata_count').text(listCount)
            }

        }

        function sign_out() {
            //로그아웃
            if (confirm('정말로 로그아웃 하시겠습니까?')){
                $.removeCookie('mytoken', {path: '/'});
                window.location.href="/login"
            }
        }
    </script>
    {% endblock %}

    {% block content %}
    <div style="width: 1194px; margin: 0px auto 40px auto">
    <section style="background: #fafafa" class="hero is-white">
        <div class="hero-body" style="padding-bottom:1rem;margin:auto;width: 70%;">
            <div style="display: flex; justify-content: space-evenly">
                <div style="margin-right: 20px;cursor:pointer;" onclick="window.location.href='/user_mentor/{{ mentor_info.nickname }}'">
                    <div style="width: 174px;height: 174px;overflow: hidden;border-radius: 87px;border: none;margin: 0px 30px 0 0">
                        <img src="../static/{{ mentor_info.profile_pic_real }}"
                             style="width:100%;height: 100%;object-fit: cover;">
                    </div>
                </div>
                <div style="width: 595px; height: 174px; margin-right: 63px;position: relative">
                    <p style="font-size: 24px;padding-left: 5px;margin-bottom: 12px">{{ mentor_info.nickname }}</p>
                    <div style="display: flex;line-height: 18px;margin-top: 4px">
                        <div class="daepyo">대표</div>
                        {% if mentorinfo_info.mentor_type[0] == '정시' %}
                            <div class="susi-jungsi">정시</div>
                        {% elif mentorinfo_info.mentor_type[0] == '' %}
                            <div class="attending">학교</div>
                        {% else %}
                            <div class="susi-jungsi">수시</div>
                        {% endif %}
                        <span>{{ mentorinfo_info.mentor_univ[0] }} {{ mentorinfo_info.mentor_major[0] }} {{ mentorinfo_info.mentor_number[0] }}학번</span>
                    </div>
                    <p style="width:595px;padding-left: 5px;font-size: 12px;padding-right: 24px; line-height: 21px; color: #797979">
                    </p>
                    <div id="user_mentor_taglist" style="display: flex;flex-wrap: wrap;position: absolute;bottom: 12px">
                        {% if mentorinfo_info.tags %}
                            {% for tag in mentorinfo_info.tags.split(',') %}
                                <div class="user_tag" onclick="window.location.href='/search?tag={{ tag[1:] }}'">{{ tag }}</div>
                            {% endfor %}
                        {% endif %}

                        {% if myFeed == True %}
                        <div onclick="$('#tag_modal').addClass('is-active');big(0)" class="modify_btn" style="text-align: center; height: 27px;line-height: 25px;font-size: 12px">태그 설정</div>
                        {% endif %}
                    </div>
                </div>
                <div style="text-align: center;margin-top: 20px">
                    <p style="min-width: 50px;text-align: center">팔로워</p>
                    <p style="font-size: 32px;margin-top: 8px">{{ follower|length }}</p>
                    {% if myFeed != True %}
                    {% if followed == 'True' %}
                        <button id="un_follow_btn" onclick="follow({{ mentor_info.number }},'unfollow');"
                                style="cursor: pointer;background-color:white; margin-top: 20px; width: 174px; height: 42px; border-radius: 21px; border: #595959 1px solid; text-align: center; padding-top: 5px; color: #595959">
                            팔로우 취소
                        </button>
                    {% else %}
                        {% if me_info %}
                        <button id="follow_btn" onclick="follow({{ mentor_info.number }},'follow');" style="cursor: pointer;background-color:#577FF0; margin-top: 20px; width: 174px; height: 42px; border-radius: 21px; border: #577FF0 1px solid; text-align: center; padding-top: 5px; color: white">
                            팔로우
                        </button>
                        {% else %}
                        <button id="follow_btn" onclick="window.location.href='/login', alert('로그인 하시면 서비스를 이용하실 수 있습니다')" style="cursor: pointer;background-color:#577FF0; margin-top: 20px; width: 174px; height: 42px; border-radius: 21px; border: #577FF0 1px solid; text-align: center; padding-top: 5px; color: white">
                            팔로우
                        </button>
                        {% endif %}
                    {% endif %}
                {% endif %}
                </div>
            </div>
        </div>
    </section>
    <div style="display: flex;margin-top:30px">
        <div style="width: 930px;position: relative;">
            <div style="width: 930px;">
                <p style="color: #595959">총&nbsp;&nbsp;<span style="color: #333333;font-size: 18px"
                                                             id="mydata_count"></span> 개의 검색결과</p>
                <br>

                <div id="mydata_list" style="display: flex;flex-wrap: wrap">
                    {% for mentor in initial_search_list %}
                        <div class="men" style="">
                            <div style="display: flex">
                                <div class="mentorcard" onclick="window.open('/user_mentor/{{ mentor[4] }}')">
                                    <div style="width: 60px;height: 60px;overflow: hidden;border-radius: 30px;margin: auto">
                                        <img src="../static/{{ mentor[0] }}"
                                             style="width:100%;height: 100%;object-fit: cover;">
                                    </div>
                                    <table style="text-align: center;width: max-content;margin: 8px auto 0 auto">
                                        <tr>
                                            <td style="color: #595959;font-size: 8px;width: 75px;">팔로워</td>
                                            <td style="color: #595959;font-size: 8px;width: 75px;">데이터</td>
                                        </tr>
                                        <tr>
                                            <td style="color: #333333;font-size: 21px;font-weight: 600">{{ mentor[1] }}</td>
                                            <td style="color: #333333;font-size: 21px;font-weight: 600">{{ mentor[2] }}</td>
                                        </tr>
                                    </table>
                                </div>
                                <div style="width: 494px;position: relative;padding-left: 12px;">
                                    <p class="tagSameCountArea"
                                       style="font-size: 18px; font-weight: 600">{{ mentor[4] }}</p>
                                    <div style="position: absolute; bottom: 5px">
                                        <p class="tagArea" style="color: #595959;font-size: 12px">{{ mentor[3] }}</p>
                                        <div style="display: flex;line-height: 18px;margin-top: 4px">
                                            {% if mentor[7] == '정시' %}
                                                <div class="susi-jungsi">정시</div>
                                            {% elif mentor[7] == '' %}
                                                <div class="attending">학교</div>
                                            {% else %}
                                                <div class="susi-jungsi">수시</div>
                                            {% endif %}
                                            <span>{{ mentor[5] }} {{ mentor[6] }} {{ mentor[8] }}학번</span>
                                        </div>
                                    </div>
                                </div>
                                <div style="width: 162px;padding-top: 11px;position: relative">
                                    {% if mentor[10] != 0 %}
                                        <button style="background: #577FF0" class="grana">학교생활기록부<img style="height: 28px;margin-top: -6px" src="../static/emoji/recordpaper.png"></button>
                                    {% else %}
                                        <button style="background: #dedede;color: #797979" class="grana">학교생활기록부<img style="height: 28px;margin-top: -6px" src="../static/emoji/recordpaper.png">
                                        </button>
                                    {% endif %}

                                    {% if mentor[11] != 0 %}
                                        <button style="background: #7351E1" class="grana">자기소개서<img style="height: 28px;margin-top: -6px" src="../static/emoji/resume.png"></button>
                                    {% else %}
                                        <button style="background: #dedede;color: #797979" class="grana">자기소개서<img style="height: 28px;margin-top: -6px" src="../static/emoji/resume.png">
                                        </button>
                                    {% endif %}

                                    {% if mentor[12] != 0 %}
                                        <button style="background: #55DBC2" class="grana">스토리<img style="height: 28px;margin-top: -6px" src="../static/emoji/story.png"></button>
                                    {% else %}
                                        <button style="background: #dedede;color: #797979" class="grana">스토리<img style="height: 28px;margin-top: -6px" src="../static/emoji/story.png"></button>
                                    {% endif %}
                                    <div onclick="window.open('/mentor_products/{{ mentor[9] }}')" class="blur"
                                         style="cursor: pointer;position: absolute;width: 164px;height: 144px;text-align: center;line-height: 142px;right: 0px;top:0px;border-radius: 4px">
                                        바로가기&nbsp;&nbsp;<i class="fa fa-external-link" aria-hidden="true"></i>
                                    </div>
                                </div>
                            </div>
                            <hr>
                        </div>
                    {% endfor %}
                </div>

            </div>
        </div>
        <div style="padding: 30px 0 0 0">
            <div style="height: max-content;width: 192px;position: sticky;top: 70px; left: 0px">
                <p style="margin-bottom: 20px;">정렬</p>
                <select style="border: none;color: #767676; border-bottom: #595959 1px solid; width: 192px;padding-bottom: 3px" id="sort_val"
                        onchange="make_product_card()">
                    <option>인기순</option>
                    <option>높은가격순</option>
                    <option>낮은가격순</option>
                </select>
                <br><br><br>

                <p style="margin-bottom: 20px;">카테고리</p>
                <label id="filter0Label" onclick="filter(0)" style="display: flex"><input type="radio" name="filter">
                    <p style="line-height: 18px">모든 데이터</p></label><br>
                <label id="filter1Label" onclick="filter(1)" style="display: flex"><input type="radio" name="filter">
                    <p style="line-height: 18px">학교생활기록부</p></label><br>
                <label id="filter2Label" onclick="filter(2)" style="display: flex"><input type="radio" name="filter">
                    <p style="line-height: 18px">자기소개서</p></label><br>
                <label id="filter3Label" onclick="filter(3)" style="display: flex"><input type="radio" name="filter">
                    <p style="line-height: 18px">스토리</p></label><br>
            </div>
        </div>
    </div>
</div>
    {% endblock %}
